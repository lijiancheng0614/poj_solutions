# 跳蚤

## 题目

给定方程 a1 * x1 + a2 * x2 + ... + an * xn + m = 1 (1 <= xi <= m)

求有多少组 n 元组 (x1, x2, ..., xn) 使得方程有整数解 (a1, a2, ..., an)


## 方法

数学 - 容斥原理

方程有解的充要条件是 gcd(x1, x2, ..., xn, m) = 1

将 m 因式分解：m = p1 ^ k1 * p2 ^ k2 + ... + pr ^ kr

则区间 [1, m] 内的整数是 pi 的倍数的有 m / pi 个，是 pi * pj 的倍数有 m / pi / pj 个

故答案为 m ^ n - [(m / p1) ^ n + (m / p2) ^ n + ... + (m / pn) ^ n] + ... + (-1) ^ (n + 1) * [m / (p1 * p2 * ... * pr)]

由容斥原理化简式 |S| - |S1 or S2 or ... or Sm| = |S| * product{1 - 1 / |Si|}

得答案为 m ^ n * product{1 - 1 / pi ^ n}

此外，当 n = 1 时，化简为 m * product{1 - 1 / pi} 即欧拉函数
